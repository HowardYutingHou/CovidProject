function [A_L, M] = assembleA_L6sb(N_c, N_r, Local, Mobility)
A_L = zeros(N_c*N_r, N_c*N_r);
M = zeros(N_c*N_r, N_c*N_r);

j = 0;
for i = 1:N_r
    ii = i + j;
    A_L(ii,ii) = Local(1,i); % alpha (beta is for nonlinear part)
    A_L(ii+1,ii+1) = -Local(3,i); % gamma
    A_L(ii+2,ii+1) = Local(3,i); % gamma
    j = j + N_c - 1;
end


% region 1
M(1,1) = -Mobility(1,1)-Mobility(1,2)-Mobility(1,3)-Mobility(1,4)-Mobility(1,5);
M(2,2) = -Mobility(2,1)-Mobility(2,2)-Mobility(2,3)-Mobility(2,4)-Mobility(2,5);
M(3,3) = -Mobility(3,1)-Mobility(3,2)-Mobility(3,3)-Mobility(3,4)-Mobility(3,5);
M(4,4) = -Mobility(4,1)-Mobility(4,2)-Mobility(4,3)-Mobility(4,4)-Mobility(4,5);
M(5,5) = -Mobility(5,1)-Mobility(5,2)-Mobility(5,3)-Mobility(5,4)-Mobility(5,5);
M(6,6) = -Mobility(6,1)-Mobility(6,2)-Mobility(6,3)-Mobility(6,4)-Mobility(6,5);
M(7,1) = Mobility(1,1);
M(8,2) = Mobility(2,1);
M(9,3) = Mobility(3,1);
M(10,4) = Mobility(4,1);
M(11,5) = Mobility(5,1);
M(12,6) = Mobility(6,1);
M(13,1) = Mobility(1,2);
M(14,2) = Mobility(2,2);
M(15,3) = Mobility(3,2);
M(16,4) = Mobility(4,2);
M(17,5) = Mobility(5,2);
M(18,6) = Mobility(6,2);
M(19,1) = Mobility(1,3);
M(20,2) = Mobility(2,3);
M(21,3) = Mobility(3,3);
M(22,4) = Mobility(4,3);
M(23,5) = Mobility(5,3);
M(24,6) = Mobility(6,3);
M(25,1) = Mobility(1,4);
M(26,2) = Mobility(2,4);
M(27,3) = Mobility(3,4);
M(28,4) = Mobility(4,4);
M(29,5) = Mobility(5,4);
M(30,6) = Mobility(6,4);
M(31,1) = Mobility(1,5);
M(32,2) = Mobility(2,5);
M(33,3) = Mobility(3,5);
M(34,4) = Mobility(4,5);
M(35,5) = Mobility(5,5);
M(36,6) = Mobility(6,5);
       
% region 2
M(1,7) = Mobility(1,6);
M(2,8) = Mobility(2,6);
M(3,9) = Mobility(3,6);
M(4,10) = Mobility(4,6);
M(5,11) = Mobility(5,6);
M(6,12) = Mobility(6,6);
M(7,7) = -Mobility(1,6)-Mobility(1,7)-Mobility(1,8)-Mobility(1,9)-Mobility(1,10);
M(8,8) = -Mobility(2,6)-Mobility(2,7)-Mobility(2,8)-Mobility(2,9)-Mobility(2,10);
M(9,9) = -Mobility(3,6)-Mobility(3,7)-Mobility(3,8)-Mobility(3,9)-Mobility(3,10);
M(10,10) = -Mobility(4,6)-Mobility(4,7)-Mobility(4,8)-Mobility(4,9)-Mobility(4,10);
M(11,11) = -Mobility(5,6)-Mobility(5,7)-Mobility(5,8)-Mobility(5,9)-Mobility(5,10);
M(12,12) = -Mobility(6,6)-Mobility(6,7)-Mobility(6,8)-Mobility(6,9)-Mobility(6,10);
M(13,7) = Mobility(1,7);
M(14,8) = Mobility(2,7);
M(15,9) = Mobility(3,7);
M(16,10) = Mobility(4,7);
M(17,11) = Mobility(5,7);
M(18,12) = Mobility(6,7);
M(19,7) = Mobility(1,8);
M(20,8) = Mobility(2,8);
M(21,9) = Mobility(3,8);
M(22,10) = Mobility(4,8);
M(23,11) = Mobility(5,8);
M(24,12) = Mobility(6,8);
M(25,7) = Mobility(1,9);
M(26,8) = Mobility(2,9);
M(27,9) = Mobility(3,9);
M(28,10) = Mobility(4,9);
M(29,11) = Mobility(5,9);
M(30,12) = Mobility(6,9);
M(31,7) = Mobility(1,10);
M(32,8) = Mobility(2,10);
M(33,9) = Mobility(3,10);
M(34,10) = Mobility(4,10);
M(35,11) = Mobility(5,10);
M(36,12) = Mobility(6,10);


% region 3
M(1,13) = Mobility(1,11);
M(2,14) = Mobility(2,11);
M(3,15) = Mobility(3,11);
M(4,16) = Mobility(4,11);
M(5,17) = Mobility(5,11);
M(6,18) = Mobility(6,11);
M(7,13) = Mobility(1,12);
M(8,14) = Mobility(2,12);
M(9,15) = Mobility(3,12);
M(10,16) = Mobility(4,12);
M(11,17) = Mobility(5,12);
M(12,18) = Mobility(6,12);
M(13,13) = -Mobility(1,11)-Mobility(1,12)-Mobility(1,13)-Mobility(1,14)-Mobility(1,15);
M(14,14) = -Mobility(2,11)-Mobility(2,12)-Mobility(2,13)-Mobility(2,14)-Mobility(2,15);
M(15,15) = -Mobility(3,11)-Mobility(3,12)-Mobility(3,13)-Mobility(3,14)-Mobility(3,15);
M(16,16) = -Mobility(4,11)-Mobility(4,12)-Mobility(4,13)-Mobility(4,14)-Mobility(4,15);
M(17,17) = -Mobility(5,11)-Mobility(5,12)-Mobility(5,13)-Mobility(5,14)-Mobility(5,15);
M(18,18) = -Mobility(6,11)-Mobility(6,12)-Mobility(6,13)-Mobility(6,14)-Mobility(6,15);
M(19,13) = Mobility(1,13);
M(20,14) = Mobility(2,13);
M(21,15) = Mobility(3,13);
M(22,16) = Mobility(4,13);
M(23,17) = Mobility(5,13);
M(24,18) = Mobility(6,13);
M(25,13) = Mobility(1,14);
M(26,14) = Mobility(2,14);
M(27,15) = Mobility(3,14);
M(28,16) = Mobility(4,14);
M(29,17) = Mobility(5,14);
M(30,18) = Mobility(6,14);
M(31,13) = Mobility(1,15);
M(32,14) = Mobility(2,15);
M(33,15) = Mobility(3,15);
M(34,16) = Mobility(4,15);
M(35,17) = Mobility(5,15);
M(36,18) = Mobility(6,15);


% region 4
M(1,19) = Mobility(1,16);
M(2,20) = Mobility(2,16);
M(3,21) = Mobility(3,16);
M(4,22) = Mobility(4,16);
M(5,23) = Mobility(5,16);
M(6,24) = Mobility(6,16);
M(7,19) = Mobility(1,17);
M(8,20) = Mobility(2,17);
M(9,21) = Mobility(3,17);
M(10,22) = Mobility(4,17);
M(11,23) = Mobility(5,17);
M(12,24) = Mobility(6,17);
M(13,19) = Mobility(1,18);
M(14,20) = Mobility(2,18);
M(15,21) = Mobility(3,18);
M(16,22) = Mobility(4,18);
M(17,23) = Mobility(5,18);
M(18,24) = Mobility(6,18);
M(19,19) = -Mobility(1,16)-Mobility(1,17)-Mobility(1,18)-Mobility(1,19)-Mobility(1,20);
M(20,20) = -Mobility(2,16)-Mobility(2,17)-Mobility(2,18)-Mobility(2,19)-Mobility(2,20);
M(21,21) = -Mobility(3,16)-Mobility(3,17)-Mobility(3,18)-Mobility(3,19)-Mobility(3,20);
M(22,22) = -Mobility(4,16)-Mobility(4,17)-Mobility(4,18)-Mobility(4,19)-Mobility(4,20);
M(23,23) = -Mobility(5,16)-Mobility(5,17)-Mobility(5,18)-Mobility(5,19)-Mobility(5,20);
M(24,24) = -Mobility(6,16)-Mobility(6,17)-Mobility(6,18)-Mobility(6,19)-Mobility(6,20);
M(25,19) = Mobility(1,19);
M(26,20) = Mobility(2,19);
M(27,21) = Mobility(3,19);
M(28,22) = Mobility(4,19);
M(29,23) = Mobility(5,19);
M(30,24) = Mobility(6,19);
M(31,19) = Mobility(1,20);
M(32,20) = Mobility(2,20);
M(33,21) = Mobility(3,20);
M(34,22) = Mobility(4,20);
M(35,23) = Mobility(5,20);
M(36,24) = Mobility(6,20);



% region 5
M(1,25) = Mobility(1,16);
M(2,26) = Mobility(2,16);
M(3,27) = Mobility(3,16);
M(4,28) = Mobility(4,16);
M(5,29) = Mobility(5,16);
M(6,30) = Mobility(6,16);
M(7,25) = Mobility(1,17);
M(8,26) = Mobility(2,17);
M(9,27) = Mobility(3,17);
M(10,28) = Mobility(4,17);
M(11,29) = Mobility(5,17);
M(12,30) = Mobility(6,17);
M(13,25) = Mobility(1,18);
M(14,26) = Mobility(2,18);
M(15,27) = Mobility(3,18);
M(16,28) = Mobility(4,18);
M(17,29) = Mobility(5,18);
M(18,30) = Mobility(6,18);
M(19,25) = Mobility(1,19);
M(20,26) = Mobility(2,19);
M(21,27) = Mobility(3,19);
M(22,28) = Mobility(4,19);
M(23,29) = Mobility(5,19);
M(24,30) = Mobility(6,19);
M(25,25) = -Mobility(1,16)-Mobility(1,17)-Mobility(1,18)-Mobility(1,19)-Mobility(1,20);
M(26,26) = -Mobility(2,16)-Mobility(2,17)-Mobility(2,18)-Mobility(2,19)-Mobility(2,20);
M(27,27) = -Mobility(3,16)-Mobility(3,17)-Mobility(3,18)-Mobility(3,19)-Mobility(3,20);
M(28,28) = -Mobility(4,16)-Mobility(4,17)-Mobility(4,18)-Mobility(4,19)-Mobility(4,20);
M(29,29) = -Mobility(5,16)-Mobility(5,17)-Mobility(5,18)-Mobility(5,19)-Mobility(5,20);
M(30,30) = -Mobility(6,16)-Mobility(6,17)-Mobility(6,18)-Mobility(6,19)-Mobility(6,20);
M(31,25) = Mobility(1,20);
M(32,26) = Mobility(2,20);
M(33,27) = Mobility(3,20);
M(34,28) = Mobility(4,20);
M(35,29) = Mobility(5,20);
M(36,30) = Mobility(6,20);


% region 6
M(1,31) = Mobility(1,21);
M(2,32) = Mobility(2,21);
M(3,33) = Mobility(3,21);
M(4,34) = Mobility(4,21);
M(5,35) = Mobility(5,21);
M(6,36) = Mobility(6,21);
M(7,31) = Mobility(1,22);
M(8,32) = Mobility(2,22);
M(9,33) = Mobility(3,22);
M(10,34) = Mobility(4,22);
M(11,35) = Mobility(5,22);
M(12,36) = Mobility(6,22);
M(13,31) = Mobility(1,23);
M(14,32) = Mobility(2,23);
M(15,33) = Mobility(3,23);
M(16,34) = Mobility(4,23);
M(17,35) = Mobility(5,23);
M(18,36) = Mobility(6,23);
M(19,31) = Mobility(1,24);
M(20,32) = Mobility(2,24);
M(21,33) = Mobility(3,24);
M(22,34) = Mobility(4,24);
M(23,35) = Mobility(5,24);
M(24,36) = Mobility(6,24);
M(25,31) = Mobility(1,25);
M(26,32) = Mobility(2,25);
M(27,33) = Mobility(3,25);
M(28,34) = Mobility(4,25);
M(29,35) = Mobility(5,25);
M(30,36) = Mobility(6,25);
M(31,31) = -Mobility(1,21)-Mobility(1,22)-Mobility(1,23)-Mobility(1,24)-Mobility(1,25);
M(32,32) = -Mobility(2,21)-Mobility(2,22)-Mobility(2,23)-Mobility(2,24)-Mobility(2,25);
M(33,33) = -Mobility(3,21)-Mobility(3,22)-Mobility(3,23)-Mobility(3,24)-Mobility(3,25);
M(34,34) = -Mobility(4,21)-Mobility(4,22)-Mobility(4,23)-Mobility(4,24)-Mobility(4,25);
M(35,35) = -Mobility(5,21)-Mobility(5,22)-Mobility(5,23)-Mobility(5,24)-Mobility(5,25);
M(36,36) = -Mobility(6,21)-Mobility(6,22)-Mobility(6,23)-Mobility(6,24)-Mobility(6,25);
